@model iLabPlus.Models.BDiLabPlus.Stocks

@{

}

<div class="modal modalWrapper" id="modalStock" tabindex="-1" role="dialog" aria-labelledby="modalCenterWarningTitle" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalStockTitle">Stock</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <form id="FormStockCreateEdit" method="post" asp-controller="Stocks" asp-action="CreateEdit" enctype="multipart/form-data" style="height:100%;">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <input asp-for="Guid" class=" form-control" hidden />
                <input asp-for="Empresa" class=" form-control" hidden />

                <div class="modal-body" id="modal-bodyStock">

                    <div class="TabsStock" style="width:100%;height:100%;">
                        <div>
                            <a>Ficha</a>
                            <div>
                                <div class="row mt-3" style="padding-top: 20px;">

                                    <div class="col-4" style="padding-left:0;">
                                        <div class="form-group form-group-default required">
                                            <label id="StkAlmacenLabel">Almacen</label>
                                            @(Html.C1().ComboBoxFor(c=> c.StkAlmacen)
                                            .Id("StkAlmacen")
                                            .OnClientGotFocus("ComboGotFocus")
                                            .OnClientSelectedIndexChanged("ComboSelectedIndexChanged")
                                            //.SelectedValuePath("Clave")
                                            //.DisplayMemberPath("Valor1")
                                            .CssStyle("z-index", "90000 !Important")
                                            .Bind(ViewBag.ListAlmacenes)
                                            .IsDisabled(false)
                                            .Width("100%"))

                                        </div>
                                    </div>

                                    <div class="col-8" style="padding-left:0;padding-right:0;">
                                        <div class="form-group form-group-default required">
                                            <label id="StkArticuloLabel">
                                                Artículo <i class="glyphicon glyphicon-info-sign" data-toggle="tooltip" data-placement="top" title="Código de Artículo" data-original-title="Tooltip on top"></i>
                                            </label>
                                            <input id="StkArticulo" type="text" class="form-control" asp-for="StkArticulo">
                                        </div>
                                    </div>

                                </div>

                                <div class="row mt-1">
                                    <div class="col-4" style="padding-left:0;">

                                    </div>

                                    <div class="col-2" style="padding-left:0;">
                                        <div class="form-group form-group-default ">
                                            <label id="StkKilatesLabel">Kilates</label>
                                            @(Html.C1().ComboBoxFor(c=> c.StkKilates)
                                            .Id("StkKilates")
                                            .OnClientGotFocus("ComboGotFocus")
                                            .OnClientSelectedIndexChanged("ComboSelectedIndexChanged")
                                            .SelectedValuePath("Clave")
                                            .DisplayMemberPath("Valor1")
                                            .CssStyle("z-index", "90000 !Important")
                                            .Bind(ViewBag.ValsysKilates)
                                            .IsDisabled(false)
                                            .Width("100%"))
                                        </div>
                                    </div>

                                    <div class="col-3" style="padding-left:0;">
                                        <div class="form-group form-group-default ">
                                            <label id="StkColorLabel">Color</label>
                                            @(Html.C1().ComboBoxFor(c=> c.StkColor)
                                            .Id("StkColor")
                                            .OnClientGotFocus("ComboGotFocus")
                                            .OnClientSelectedIndexChanged("ComboSelectedIndexChanged")
                                            .SelectedValuePath("Clave")
                                            .DisplayMemberPath("Valor1")
                                            .CssStyle("z-index", "90000 !Important")
                                            .Bind(ViewBag.ValsysColores)
                                            .IsDisabled(false)
                                            .Width("100%"))
                                        </div>
                                    </div>

                                    <div class="col-3" style="padding-left: 0; padding-right: 0;">
                                        <div class="form-group form-group-default ">
                                            <label id="StkAcabadoLabel">Acabado</label>
                                            @(Html.C1().ComboBoxFor(c=> c.StkAcabado)
                                            .Id("StkAcabado")
                                            .OnClientGotFocus("ComboGotFocus")
                                            .OnClientSelectedIndexChanged("ComboSelectedIndexChanged")
                                            .SelectedValuePath("Clave")
                                            .DisplayMemberPath("Valor1")
                                            .CssStyle("z-index", "90000 !Important")
                                            .Bind(ViewBag.ValsysColores)
                                            .IsDisabled(false)
                                            .Width("100%"))
                                        </div>
                                    </div>

                                </div>

                                <div class="row mt-1">
                                    <div class="col-4" style="padding-left:0;">

                                    </div>

                                    <div class="col-2" style="padding-left:0;">
                                        <div class="form-group form-group-default">
                                            <label id="StkFisicoLabel">Físico</label>
                                            <input id="StkFisico" type="text" class="form-control InputDecimalMask" oninput="LimitNumbers(this);" asp-for="StkFisico">
                                        </div>
                                    </div>

                                    <div class="col-2" style="padding-left:0;">
                                        <div class="form-group form-group-default">
                                            <label id="SStkReservadoLabel">Reservado</label>
                                            <input id="StkReservado" type="text" class="form-control InputDecimalMask" oninput="LimitNumbers(this);" asp-for="StkReservado">
                                        </div>
                                    </div>

                                </div>

                                <div class="row mt-1">
                                    <div class="col-4" style="padding-left:0;">

                                    </div>

                                    <div class="col-2" style="padding-left:0;">
                                        <div class="form-group form-group-default">
                                            <label id="StkMinimoLabel">Mínimo</label>
                                            <input id="StkMinimo" type="text" class="form-control InputDecimalMask" oninput="LimitNumbers(this);" asp-for="StkMinimo">
                                        </div>
                                    </div>

                                    <div class="col-2" style="padding-left:0;">
                                        <div class="form-group form-group-default">
                                            <label id="StkMaximoLabel">Máximpo</label>
                                            <input id="StkMaximo" type="text" class="form-control InputDecimalMask" oninput="LimitNumbers(this);" asp-for="StkMaximo">
                                        </div>
                                    </div>

                                </div>

                                <div class="row mt-1">
                                    <div class="col-4" style="padding-left:0;">

                                    </div>

                                    <div class="col-8" style="padding-left:0;">
                                        <div class="form-group form-group-default">
                                            <label id="StkUbicacionLabel">Ubicación</label>
                                            <input id="StkUbicacion" type="text" class="form-control" asp-for="StkUbicacion">
                                        </div>
                                    </div>

                                </div>


                                <div class="row IsoDatBottom" style="margin-top: 2rem !important;">

                                    <div class="col-4" style="padding-left:0;">
                                    </div>

                                    <div class="col-3" style="padding-left:0;">
                                        <div class="form-group form-group-default disabled">
                                            <label>Fecha Alta</label>
                                            <input id="IsoFecAlt" type="text" class="form-control" asp-for="IsoFecAlt" disabled>
                                        </div>
                                    </div>

                                    <div class="col-3" style="padding-left:0;">
                                        <div class="form-group form-group-default disabled">
                                            <label>Fecha Modificación</label>
                                            <input id="IsoFecMod" type="text" class="form-control" asp-for="IsoFecMod" disabled>
                                        </div>
                                    </div>


                                    <div class="col-2" style="padding-left: 0; padding-right: 0;">
                                        <div class="form-group form-group-default disabled">
                                            <label>Usuario</label>
                                            <input id="IsoUser" type="text" class="form-control" asp-for="IsoUser" disabled>
                                        </div>
                                    </div>

                                </div>

                            </div>


                        </div>

                        <div>
                            <a>Movimientos Stock</a>
                            <div>

                                @*@(Html.C1().FlexGrid()
                                .Id("gridStocksMov")
                                .AlternatingRowStep(0)
                                .AllowDragging(C1.Web.Mvc.Grid.AllowDragging.Columns)
                                .AllowPinning(true)
                                .AutoSizeMode(AutoSizeMode.Both)
                                .AutoScroll(false)
                                .AutoSearch(true)
                                .CssClass("flexgrid GridEvents")
                                .DefaultRowSize(27)
                                .Filterable(f => {
                                    f.DefaultFilterType(FilterType.Both);
                                    f.Id("theGridFilter");
                                })
                                .CssStyle("margin-top", "25px")
                                .HeadersVisibility(HeadersVisibility.Column)
                                .IsReadOnly(true)
                                .SelectionMode(C1.Web.Mvc.Grid.SelectionMode.Row)
                                .SortingType(C1.Web.Mvc.Grid.AllowSorting.SingleColumn)
                                .Bind(Model.ListCotizaciones)
                                .AutoGenerateColumns(false)
                                .OrderBy("Stock")
                                .FrozenColumns((int)@ViewBag.ColumnsPinnedUser)
                                .ColumnLayout((string)@ViewBag.ColumnsLayoutUser)
                                .Columns(col =>
                                {
                                    col.Add(c => c.Binding("Guid").Header("Guid").Width("100").Visible(false));

                                    col.Add(c => c.Binding("StkArticulo").Header("Articulo").Width("120"));
                                    //col.Add(c => c.Binding("DivFecha").Header("Fecha").Width("130"));

                                    //col.Add(c => c.Binding("DivCambio").Header("Cambio").Width("150*").Align("right").Format("n5"));

                                })
                                )*@
                            </div>

                        </div>
                    </div>
                </div>
            </form>

            <div class="modal-footer">
                <button type="button" id="modalStock-cancel" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                <button type="button" id="modalStock-ok" class="btn btn-primary " >Aceptar</button>
            </div>

        </div>
    </div>
</div>

@(Html.C1().TabPanel(".TabsStock"))


<script>



    $(document).ready(function () {

        $("body").tooltip({ selector: '[data-toggle=tooltip]' });

        var theGridCus = wijmo.Control.getControl("#gridStocksMov");
        if (theGridCus) {
            theGridCus.select(-1, -1);
        }

        // Posiciona en la primera tab
        var TabsObj = wijmo.Control.getControl('.TabsStock');
        $('#modalStock').on('show.bs.modal', function () {
            TabsObj.selectedIndex = 0;
        });



        $('.InputDecimalMask').inputmask("decimal", {
            'digits': 3,
            groupSeparator: ".",
            radixPoint: ",",
            autoGroup: true,
        });
        $(".InputDecimalMask").on("click", function () {
            $(this).select();
        });

        $('.InputIntegerMask').inputmask("integer", {
            groupSeparator: ".",
            radixPoint: ",",
            autoGroup: true,
        });
        $(".InputIntegerMask").on("click", function () {
            $(this).select();
        });


        var ModelGuid = "@Model.Guid";

        if (ModelGuid == '00000000-0000-0000-0000-000000000000') {
            document.getElementById("StkArticulo").focus();

            //var inputDivFecha = wijmo.Control.getControl('#DivFecha');
            //inputDivFecha.value = moment(new Date()).format('YYYY-MM-DD');

        } else {
            $("#Stock").prop("disabled", true);
            $("#Stock").parent().addClass("disabled");
        }




    });






</script>